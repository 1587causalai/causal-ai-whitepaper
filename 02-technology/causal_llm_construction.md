# 理论框架

构建擅长洞察因果关系的下一代大模型的理论框架。

核心架构思路：不再是单纯的next token prediction，而是同时进行分类和回归。

## 1. 核心设计哲学与目标

该因果基座大模型的设计，根植于您提出的 **DiscoSCM（Distribution-Consistency Structural Causal Models** 框架。其核心哲学思想包含：

*   **个体因果的普遍性与柯西分布的必然性**: 每个个体（或样本）拥有其独特的潜在因果表征 $\vec{C}$，这些表征的差异导致了观测结果的差异。柯西分布的极重尾特性被用来数学化地表达"任何结果对任何个体都具有非零可能性"的无限开放信念。
*   **潜在因果表征的认知不确定性**: 模型永远无法直接观测到"真实"的因果表征 $\vec{C}$，只能根据可观测数据 $x$ 和 $y_{true}$ 来推断其后验概率分布 $P(\vec{C}|x)$。这个概率分布本身即代表了模型对个体因果状态的全部认知。

模型的目标是超越传统的预测任务，构建一个能够：
1.  同时处理**数值回归**和**多类别分类**任务。
2.  显式地学习和表征潜在的因果因素 $\vec{C}$。
3.  基于 $\vec{C}$ 生成对目标变量的概率分布预测，从而捕捉不确定性。
4.  为新知识的融入（如通过KLD约束下的差量矩阵学习）提供结构化的基础。

## 2. 模型架构概览

该模型可以概念化为一个端到端的可训练系统，提供基础版本和高级版本两种配置。


```
输入 X (文本/数值)
        ↓
┌─────────────────────┐
│ Transformer 主干网络 │
└─────────────────────┘
        ↓
   上下文表征 h(x)
        ↓
┌─────────────────────┐
│  因果表征生成网络    │
└─────────────────────┘
        ↓
潜在因果表征 P(C|x) ~ Cauchy(μ_C(h), γ_C(h))
        ↓
    ┌───────┴───────┐
    ↓               ↓
┌─────────┐    ┌──────────────┐
│数值回归头 │    │分类输出头     │
│         │    │(分段函数法)   │
└─────────┘    └─────────────┘
    ↓               ↓
数值输出         类别概率
P(y_num|x)      P(y_class|x)
~ Cauchy
```


```
输入层:
  X (词元序列 + 数值标记)

编码层:
  Transformer → h(x) ∈ ℝᴹ

因果表征层:
  h(x) → [μ_C(h), γ_C(h)] → P(C|x) = ∏ᵢ Cauchy(μᵢ, γᵢ)
  
输出层:
  分支1: C → W_reg·C + b_reg → P(y_num|x) ~ Cauchy
  分支2: C → w_s·C + b_s → W_class ~ Cauchy → OvR → P(y_class|x)
```

## 3. 关键组件详述

### 3.1 特征网络获得输入编码器与上下文表征 $h(x)$

*   **输入 $X$**: 可以是词元序列，也可能包含特殊标记的数值。
*   **Transformer 主干网络**: 采用标准的Transformer架构（如Encoder-Decoder或Decoder-only），将输入 $X$ 映射为一个高维的上下文表征 $h(x)$。这个 $h(x)$ 旨在充分捕捉输入信息中的相关上下文。

### 3.2 推断网络获得潜在因果表征 $P(\vec{U}|x)$

*   $\vec{U}$ 服从多元柯西分布或者独立柯西分布，是模型的核心创新所在。
*   **最简单的推断网络**: 输出多元柯西分布的参数：
    *   位置向量: $\vec{\mu}_{\vec{U}}(h) = W_{\mu} h(x) + b_{\mu} \in \mathbb{R}^D$
    *   尺度矩阵: $\mathbf{\Sigma}_{\vec{U}}(h)$ 被设定为对角矩阵，通过输出 $D$ 个独立的尺度参数 $\gamma_{U_i}(h)$ 构建
*   **潜在因果表征 $\vec{U}$**: 服从多元柯西分布 $\vec{U}|x \sim \text{MCauchy}(\vec{\mu}_{\vec{U}}(h), \mathbf{\Sigma}_{\vec{U}}(h))$

### 3.3 行动网络获得数值或者类别输出

数值回归输出模块 ($P(\hat{y}_{num}|x)$) ...

分类输出模块 ($P(y_{class}|x)$) ...





